(function(t){function e(e){for(var a,s,n=e[0],c=e[1],r=e[2],u=0,h=[];u<n.length;u++)s=n[u],Object.prototype.hasOwnProperty.call(l,s)&&l[s]&&h.push(l[s][0]),l[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(h.length)h.shift()();return o.push.apply(o,r||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],a=!0,n=1;n<i.length;n++){var c=i[n];0!==l[c]&&(a=!1)}a&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var a={},l={app:0},o=[];function s(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=a,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/material-order-production/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var r=0;r<n.length;r++)e(n[r]);var d=c;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"1d6f":function(t,e,i){"use strict";i("a6ac")},"4b24":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("e792"),i("0cdd");var a=i("2b0e"),l=i("5f5b");i("ab8b"),i("2dd8");a["default"].use(l["b"]);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("b-container",[i("div",{staticStyle:{width:"1108px"}},[i("div",{staticClass:"header-bar clearfix mb-1"},[i("div",{staticClass:"left",staticStyle:{float:"left"}},[t._v(" Total Order Cost: "),i("span",{style:t.overUnderAllocated?"color: red":""},[t._v(t._s(t.totalAllocatedCost))]),t._v(" / "+t._s(t.totalCost)+" ")]),i("div",{staticClass:"right",staticStyle:{float:"right"}},[i("b-button",{staticClass:"mr-3",attrs:{disabled:!t.updatedAndNoNegatives,variant:t.updatedAndNoNegatives?"success":"light",size:"sm"},on:{click:t.handleSave}},[t._v(" Save Changes "),i("b-icon",{attrs:{variant:t.updatedAndNoNegatives?"light":"dark",icon:"upload"}})],1),i("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(e){t.show=!t.show}}},[t._v(" Add New "),i("b-icon",{attrs:{variant:"light",icon:"plus"}})],1)],1)]),i("material-order-table",{ref:"table",attrs:{"job-items":t.materialOrderItems,typeList:t.typeList,totalCost:t.totalCost,allocationTypeList:t.allocationTypeList,shipmentList:t.shipmentList},on:{delete:t.handleDelete,"update-job-item":t.updateJobItem,"set-cost-allocation":t.setCostAllocation,"set-quantity":t.setQuantity,"set-allocated-cost":t.setAllocatedCost,"set-updated":t.setUpdated}}),i("div",{staticClass:"mt-1",staticStyle:{float:"left"}},[i("b-button",{attrs:{variant:"outline-danger",size:"sm"}},[t._v(" Reset Table Data "),i("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise"}})],1)],1),i("div",{staticClass:"mt-1",staticStyle:{float:"right"}},[i("b-button",{staticClass:"mr-3",attrs:{variant:"outline-info",size:"sm"},on:{click:t.handleDistribute}},[t._v(" Distribute Remaining Dollars "),i("b-icon",{staticClass:"ml-2",attrs:{icon:"shuffle"}})],1),i("b-button",{attrs:{variant:"info",size:"sm"},on:{click:t.handleSplit}},[t._v(" Allocate by Qty Fulfilled "),i("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-left-right"}})],1)],1),i("modal-entry",{attrs:{show:t.show,typeList:t.typeList,allocationTypeList:t.allocationTypeList},on:{"update-show":t.setShow,"create-new-material-allocation":t.createNewMaterialAllocation}}),i("b-modal",{attrs:{"header-class":"text-center","body-class":"text-center"},scopedSlots:t._u([{key:"modal-header",fn:function(){return[i("div",{staticClass:"w-100 font-weight-bold",staticStyle:{"font-size":"1.4rem"}},[t._v(" Are you Sure? ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("b-button",{staticClass:"mr-auto",attrs:{variant:"secondary"},on:{click:function(e){t.confirmationShow=!1}}},[t._v("Cancel")]),i("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.deleteMaterialAllocation(t.deletableItem)}}},[t._v("Delete")])]},proxy:!0}]),model:{value:t.confirmationShow,callback:function(e){t.confirmationShow=e},expression:"confirmationShow"}},[i("span",[t._v("Delete This Material Allocation?")]),i("br"),t._v(" "+t._s(t.deletableItem.jobItem.name)+" ")]),i("b-modal",{attrs:{"header-class":"text-center","body-class":"text-center"},scopedSlots:t._u([{key:"modal-header",fn:function(){return[i("div",{staticClass:"w-100 font-weight-bold",staticStyle:{"font-size":"1.4rem"}},[t._v(" Are you Sure? ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("b-button",{staticClass:"mr-auto",attrs:{variant:"secondary"},on:{click:function(e){t.saveConfirmationShow=!1}}},[t._v("Cancel")]),i("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.saveChanges()}}},[t._v("Save Changes")])]},proxy:!0}]),model:{value:t.saveConfirmationShow,callback:function(e){t.saveConfirmationShow=e},expression:"saveConfirmationShow"}},[i("span",[t._v("Save These Changes to the Database?")]),i("br"),t._l(t.materialOrderItems,(function(e){return i("span",{key:e.id},[t._v(t._s(e.jobItem.name)),i("br")])}))],2)],1)])],1)},s=[],n=i("5530"),c=(i("d3b7"),i("159b"),i("2af1"),i("b680"),i("a9e3"),i("ac1f"),i("466d"),i("25f0"),i("caad"),i("2532"),i("7db0"),i("a434"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"table text-left m-0",staticStyle:{"font-size":".6rem",width:"1108px","border-collapse":"collapse","border-spacing":"0",border:"1px solid rgba(0,0,0,.4)"}},[i("thead",[i("tr",{style:t.locked?"background-color: rgba(0,0,0,.1)":"",attrs:{id:"table-head"}},[i("th",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-center",staticStyle:{width:"4rem"},attrs:{title:"Material Order ID #"}},[t._v("ID #")]),i("th",{staticClass:"text-center",staticStyle:{width:"5.5rem"}},[t._v("Allocation Type")]),i("th",{staticClass:"text-center",staticStyle:{width:"5.5rem"}},[t._v("Material Type")]),i("th",{staticClass:"text-center",staticStyle:{width:"4rem"}},[t._v("Qty Lines")]),i("th",{staticClass:"text-center",staticStyle:{width:"9rem"}},[t._v("Job Item")]),i("th",{staticClass:"text-center",staticStyle:{width:"6rem"}},[t._v("Last Shipment In")]),i("th",{staticClass:"text-center",staticStyle:{"border-right":"none",width:"5rem"}},[i("b-row",{staticClass:"m-0"},[i("b-col",{staticClass:"p-0 w-100",attrs:{cols:"12",lg:"6"}},[i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"align-self-center  pr-2",staticStyle:{display:"inline-block","vertical-align":"sub"},attrs:{title:"Job Item Qty"}},[t._v(" JI Qty ")])]),i("b-col",{staticClass:"p-0"},[i("b-button",{staticClass:"table-button w-100",attrs:{disabled:!!t.locked,size:"sm",variant:"outline-dark"},on:{click:t.setAllJobQty}},[i("b-icon",{attrs:{scale:".75",icon:"chevron-double-right"}})],1)],1)],1)],1),i("th",{staticStyle:{width:"4rem"}},[i("b-row",{staticClass:"m-0"},[i("b-col",{staticClass:"p-0 text-center align-self-center",attrs:{cols:"11",lg:"11"}},[t._v(" Qty Fulfilled ")])],1)],1),i("th",{staticClass:"text-center",staticStyle:{width:"6rem"}},[t._v(" Cost Allocation: $ ")]),i("th",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.left",modifiers:{hover:!0,left:!0}}],staticClass:"text-center",staticStyle:{width:"4rem"},attrs:{title:"Cost Allocation: %"}},[t._v("% Allocation ")]),i("th",{staticClass:"text-center",staticStyle:{width:"4rem"}},[i("b-button",{staticClass:"table-button w-100",attrs:{size:"sm",variant:"outline-dark"},on:{click:t.setAllLocked}},[i("b-icon",{attrs:{scale:".75",icon:t.locked?"lock-fill":"unlock-fill"}})],1)],1),i("th",{staticClass:"text-center",staticStyle:{width:"2rem"}},[t._v("Del")])])]),i("tbody",t._l(t.jobItems,(function(e){return i("material-order-job-item",{key:e.jobItem.id,ref:"item",refInFor:!0,attrs:{item:e,index:e.id,typeList:t.typeList,allocationTypeList:t.allocationTypeList,shipmentList:t.shipmentList,totalCost:t.totalCost},on:{delete:function(i){return t.$emit("delete",e)},"update-job-item":t.updateJobItem,"set-allocated-cost":function(e){return t.$emit("set-allocated-cost")},"set-quantity":t.setQtyFulfilled,"set-updated":t.setUpdated}})})),1)])}),r=[],d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"table-body",style:t.borderBackgroundColor},[i("td",{staticStyle:{width:"3rem"},style:(t.updated,"")},[t._v(t._s(t.index))]),i("td",{staticClass:"text-center"},[i("b-select",{staticClass:"pl-1",attrs:{plain:"",disabled:!!t.locked,options:t.allocationTypeList},model:{value:t.allocationType,callback:function(e){t.allocationType=e},expression:"allocationType"}})],1),i("td",{staticClass:"text-center",style:(t.updated,"")},[i("b-select",{staticClass:"pl-1",attrs:{plain:"",disabled:!!t.locked,options:t.typeList},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),i("td",{staticStyle:{"max-width":"2rem"},style:(t.updated,"")},[i("b-input",{staticClass:"w-100 text-right",staticStyle:{"vertical-align":"text-top"},attrs:{disabled:!!t.locked,type:"number"},model:{value:t.qtyLines,callback:function(e){t.qtyLines=e},expression:"qtyLines"}})],1),i("td",{staticClass:"text-center",style:(t.updated,"")},[t._v(" "+t._s(t.jobItem)+" ")]),i("td",{staticClass:"text-center",style:(t.updated,"")},[i("b-select",{staticClass:"pl-1",attrs:{plain:"",disabled:!!t.locked,options:t.shipmentList},model:{value:t.lastShipmentIn,callback:function(e){t.lastShipmentIn=e},expression:"lastShipmentIn"}})],1),i("td",{staticStyle:{"border-right":"none"},style:(t.updated,"")},[i("b-row",{staticClass:"m-0 text-center"},[i("b-col",{staticClass:"p-0 w-100",attrs:{cols:"12",lg:"6"}},[i("div",{staticClass:"pr-2",staticStyle:{display:"inline-block","vertical-align":"sub"}},[t._v(" "+t._s(t.jobItemQty)+" ")])]),i("b-col",{staticClass:"p-0"},[i("b-button",{staticClass:"table-button w-100",attrs:{disabled:!!t.locked,size:"sm",variant:"outline-dark"},on:{click:function(e){return t.setQtyFulfilled()}}},[i("b-icon",{attrs:{scale:".75",icon:"chevron-double-right"}})],1)],1)],1)],1),i("td",{staticStyle:{"max-width":"4rem"}},[i("b-row",{staticClass:"m-0"},[i("b-col",{staticClass:"p-0",attrs:{cols:"11",lg:"11"}},[i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.topleft",value:{customClass:"tooltip"},expression:"{customClass: 'tooltip'}",modifiers:{topleft:!0}}],attrs:{title:t.jobItemQtyMatch?"":"Job Item Qty & Qty fulfilled are not equivalent"}},[i("b-input",{staticClass:"text-right pr-1 w-100",staticStyle:{"vertical-align":"sub"},style:t.jobItemQtyMatch?"":t.borderBlue,attrs:{disabled:!!t.locked,type:"number",min:"0"},model:{value:t.qtyFulfilled,callback:function(e){t.qtyFulfilled=e},expression:"qtyFulfilled"}})],1)])],1)],1),i("td",{staticClass:"text-center"},[i("b-row",{staticClass:"m-0 p-0 "},[i("span",{staticStyle:{"vertical-align":"text-top"}},[t._v("$ ")]),i("b-input",{ref:"costAllocationInput",staticClass:"text-right p-0 pr-1",staticStyle:{"vertical-align":"text-top",width:"85%"},style:t.isNegative?t.borderRed:"",attrs:{disabled:!!t.locked,step:".01",type:"number",value:t.costAllocationDecimal},on:{blur:t.setCostAllocation}})],1)],1),i("td",{staticClass:"text-center",style:(t.updated,"")},[t._v(" "+t._s(t.percentAllocation||0)+" % ")]),i("td",{staticClass:"text-center"},[i("b-button",{staticClass:"table-button w-100",attrs:{size:"sm",variant:"outline-dark"},on:{click:function(e){t.locked=!t.locked}}},[i("b-icon",{attrs:{scale:".75",icon:t.locked?"lock-fill":"unlock-fill"}})],1)],1),i("td",{staticClass:"text-center",style:(t.updated,"")},[i("b-button",{staticClass:"p-0",staticStyle:{border:"none"},attrs:{size:"sm",variant:"outline-light"},on:{click:function(e){return t.$emit("delete")}}},[i("b-icon",{attrs:{variant:"danger",scale:"1",icon:"trash"}})],1),t.updated?i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-lg-2 info-icon",staticStyle:{"vertical-align":"center !important"},attrs:{title:"Job Item has updates that need to be saved",variant:"primary",icon:"info-circle","font-scale":"2"}}):t._e()],1)])},u=[],h=(i("b0c0"),{name:"MaterialOrderJobItem",data:function(){return{locked:!1,updated:!1,iconHovered:!1,id:null,type:null,allocationType:null,jobItem:null,jobItemQty:null,qtyFulfilled:0,costAllocation:0,qtyLines:null,lastShipmentIn:null,selectedType:null,percentAllocation:0}},props:{shipmentList:Array,item:{type:Object,twoWay:!0},index:Number,typeList:Array,allocationTypeList:Array,calculatedCost:Number,totalCost:Number},computed:{borderBackgroundColor:function(){var t="";return this.locked&&(t+="background-color: rgba(0,0,0,.1);"),this.updated&&(t+=""),t},isNegative:function(){return-1===Math.sign(this.costAllocation)},costAllocationDecimal:function(){return parseFloat(this.costAllocation).toFixed(2)},borderRed:function(){return"border: 2px solid rgba(193,0,0,.4);"},borderBlue:function(){return"border: 2px solid rgba(0,0,255,1);"},borderYellow:function(){return"border-top: 2px solid rgba(255,247,0,.4); border-bottom: 2px solid rgba(255,247,0,.4);"},borderGreen:function(){return"border: 2px solid rgba(0,128,9,1);"},jobItemQtyMatch:function(){return parseFloat(this.jobItemQty)===parseFloat(this.qtyFulfilled)}},watch:{item:{deep:!0,handler:function(){this.resetItemRef(),this.$emit("set-allocated-cost"),this.compareAllFields()&&this.updateItem()}},locked:function(){},type:function(){this.type!==this.item.type&&(this.updated=!0,this.$emit("set-updated",!0))},allocationType:function(){this.allocationType!==this.item.allocationType&&(this.updated=!0,this.$emit("set-updated",!0))},qtyFulfilled:function(){this.qtyFulfilled!==this.item.qtyFulfilled&&(this.updated=!0,this.$emit("set-updated",!0))},costAllocation:function(){this.costAllocation!==this.item.costAllocation&&(this.locked=!0,this.updated=!0,this.$emit("set-updated",!0))},qtyLines:function(){this.qtyLines!==this.item.qtyLines&&(this.updated=!0,this.$emit("set-updated",!0))},lastShipmentIn:function(){this.lastShipmentIn!==this.item.lastShipmentIn&&(this.updated=!0,this.$emit("set-updated",!0))}},updated:function(){this.updateItem()},methods:{compareAllFields:function(){return this.lastShipmentIn!==this.item.lastShipmentIn||(this.qtyLines!==this.item.qtyLines||(this.costAllocation!==this.item.costAllocation||(this.qtyFulfilled!==this.item.qtyFulfilled||(this.type!==this.item.type||this.allocationType!==this.item.allocationType))))},updateItem:function(){var t=Object(n["a"])({},this.item);t.type=this.type,t.allocationType=this.allocationType,t.qtyFulfilled=parseInt(this.qtyFulfilled),this.costAllocation?t.costAllocation=parseFloat(this.costAllocation):t.costAllocation=0,t.qtyLines=parseInt(this.qtyLines),t.lastShipmentIn=this.lastShipmentIn,this.$emit("update-job-item",t)},iconHover:function(t){this.iconHovered=t},setCostAllocation:function(){""===this.$refs.costAllocationInput.$el.value||0===this.$refs.costAllocationInput.$el.value?this.costAllocation=null:this.costAllocation=this.$refs.costAllocationInput.$el.value},resetItemRef:function(){this.id=this.item.id,this.type=this.item.type,this.allocationType=this.item.allocationType,this.jobItem=this.item.jobItem.name,this.jobItemQty=this.item.jobItem.qty,this.qtyFulfilled=this.item.qtyFulfilled,this.costAllocation=this.item.costAllocation,this.qtyLines=this.item.qtyLines,this.lastShipmentIn=this.item.lastShipmentIn},setQtyFulfilled:function(t){null!=t?this.$emit("set-quantity",this.item,t):this.$emit("set-quantity",this.item)}},created:function(){null!=this.item.costAllocation&&0!==this.item.costAllocation&&(this.locked=!0),this.resetItemRef()}}),m=h,f=(i("8084"),i("2877")),p=Object(f["a"])(m,d,u,!1,null,"245754f6",null),b=p.exports,y={name:"MaterialOrderTable",components:{MaterialOrderJobItem:b},data:function(){return{locked:!1}},props:{jobItems:Array,typeList:Array,allocationTypeList:Array,shipmentList:Array,totalCost:Number},computed:{totalQtyFulfilled:function(){var t=0;return this.jobItems.forEach((function(e){t+=e.qtyFulfilled})),t},totalAllocatedCost:function(){var t=0;return this.jobItems.forEach((function(e){t+=e.costAllocation})),t}},methods:{setUpdated:function(t){this.$emit("set-updated",t)},setAllLocked:function(){var t=this;this.locked=!this.locked,this.$refs.item.forEach((function(e){e.locked=t.locked}))},setQtyFulfilled:function(t,e){this.$emit("set-quantity",t,e)},setCostAllocation:function(t){this.$emit("set-cost-allocation",t)},updateJobItem:function(t){this.$emit("update-job-item",t)},costAllocationMethod:function(t){var e=0;return this.jobItems.forEach((function(t){t.qtyFulfilled&&(e+=t.qtyFulfilled)})),parseFloat((this.totalCost*(t.qtyFulfilled/e)).toFixed(2))},setAllJobQty:function(){this.$refs.item.forEach((function(t){t.setQtyFulfilled()}))}}},v=y,A=(i("1d6f"),Object(f["a"])(v,c,r,!1,null,"39ec61ca",null)),S=A.exports,I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{size:"lg",centered:"",id:"modal-1",title:"New Material Allocation"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[i("div",{staticClass:"w-100"},[i("b-button",{staticClass:"float-left",attrs:{variant:"secondary",size:"sm"},on:{click:function(e){t.showRef=!1}}},[t._v(" Cancel ")]),i("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"sm"},on:{click:t.validate}},[t._v(" Add Material Allocation ")])],1)]},proxy:!0}]),model:{value:t.showRef,callback:function(e){t.showRef=e},expression:"showRef"}},[i("b-row",{staticClass:"pl-5 pr-5 align-content-center",staticStyle:{height:"23rem"}},[i("b-col",[i("b-form",[i("div",{staticStyle:{position:"relative"}},[t.selectJob?i("label",{staticStyle:{"font-size":".6rem",color:"red",position:"absolute",bottom:"0%"},attrs:{for:"this-selected-job"}},[t._v(" Job Must Be selected ")]):t._e(),i("label",{staticClass:"m-0 pl-2",attrs:{for:"this-selected-job"}},[t._v(" Job: ")]),i("b-form-select",{staticClass:"mb-4",attrs:{id:"this-selected-job",options:t.jobsList},model:{value:t.selectedJob,callback:function(e){t.selectedJob=e},expression:"selectedJob"}})],1),i("div",{staticStyle:{position:"relative"}},[t.selectAllocationType?i("label",{staticStyle:{"font-size":".6rem",color:"red",position:"absolute",bottom:"0%"},attrs:{for:"this-selected-allocation"}},[t._v(" Allocation must be selected ")]):t._e(),i("label",{staticClass:"m-0 pl-2",attrs:{for:"this-selected-allocation"}},[t._v(" Allocation Type: ")]),i("b-form-select",{staticClass:"mb-4",attrs:{id:"this-selected-allocation",options:t.allocationTypeList},model:{value:t.selectedAllocationType,callback:function(e){t.selectedAllocationType=e},expression:"selectedAllocationType"}})],1),i("div",{staticStyle:{position:"relative"}},[t.selectMaterialType?i("label",{staticStyle:{"font-size":".6rem",color:"red",position:"absolute",bottom:"-40%"},attrs:{for:"this-selected-material"}},[t._v(" Material Type must be selected ")]):t._e(),i("label",{staticClass:"m-0 pl-2",attrs:{for:"this-selected-material"}},[t._v(" Material Type: ")]),i("b-form-select",{attrs:{id:"this-selected-material",options:t.typeList},model:{value:t.selectedType,callback:function(e){t.selectedType=e},expression:"selectedType"}})],1)])],1),i("b-col",{staticClass:"p-0"},[i("div",{staticStyle:{position:"relative"}},[t.checkJobItems?i("label",{staticStyle:{"font-size":".6rem",color:"red",position:"absolute",top:"-5%",left:"2%"},attrs:{for:"this-checked-jobitems"}},[t._v(" Job Item(s) Must be Checked ")]):t._e(),null!==t.selectedJob?i("b-card",{staticStyle:{position:"relative","overflow-y":"scroll","max-height":"21rem"},attrs:{id:"this-checked-jobitems"}},[i("b-card-header",{staticClass:"p-0 clearfix",staticStyle:{"background-color":"inherit"}},[t._v(" Open Job Items "),t.allSelected?t._e():i("a",{staticStyle:{"font-size":".6rem",float:"right"},attrs:{href:"#"},on:{click:function(e){return t.selectAll(!0)}}},[t._v("Select All")]),t.allSelected?i("a",{staticStyle:{"font-size":".6rem",float:"right"},attrs:{href:"#"},on:{click:function(e){return t.selectAll(!1)}}},[t._v("UnSelect All")]):t._e()]),i("b-card-body",t._l(t.jobItemList,(function(e){return i("b-form-checkbox",{key:e.id,model:{value:e.checked,callback:function(i){t.$set(e,"checked",i)},expression:"item.checked"}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e()],1)])],1)],1)},C=[],k={name:"ModalEntry",mounted:function(){},methods:{validate:function(){this.selectedJob?this.selectJob=!1:this.selectJob=!0,this.selectedAllocationType?this.selectAllocationType=!1:this.selectAllocationType=!0,this.selectedType?this.selectMaterialType=!1:this.selectMaterialType=!0,this.jobItemList.some((function(t){return!0===t.checked}))?this.checkJobItems=!1:this.selectedJob&&(this.checkJobItems=!0),this.selectJob||this.selectMaterialType||this.selectAllocationType||this.checkJobItems||this.createNewMaterialAllocation()},resetErrors:function(){this.selectJob=!1,this.selectAllocationType=!1,this.selectMaterialType=!1,this.checkJobItems=!1},resetVariables:function(){this.selectedJob=null,this.selectedAllocationType=null,this.selectedType=null,this.jobItemList.forEach((function(t){t.checked=!1}))},selectAll:function(t){this.jobItemList.forEach((function(e){e.checked=t})),this.allSelected=t},createNewMaterialAllocation:function(){var t=[];this.jobItemList.forEach((function(e){e.checked&&t.push({id:e.id,name:e.name,qty:e.qty})}));var e={data:t,type:this.selectedType,allocationType:this.selectedAllocationType};this.showRef=!1,this.$emit("create-new-material-allocation",e)}},watch:{selectedJob:function(){},showRef:function(){this.$emit("update-show",this.showRef)},show:function(){!1===this.show&&(this.resetErrors(),this.resetVariables()),this.showRef=this.show}},data:function(){return{selectedJob:null,selectedType:null,selectedAllocationType:null,showRef:!1,checkJobItems:!1,selectJob:!1,selectAllocationType:!1,selectMaterialType:!1,allSelected:!1,jobsList:[{value:null,text:"Select..."},"TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A","TPS-40961-A"],jobItemList:[{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1},{id:Math.random(),name:"TPS-04961-A_2022-04-16",qty:2,checked:!1}]}},created:function(){this.showRef=this.show},props:{show:Boolean,typeList:Array,allocationTypeList:Array,baseURL:String}},g=k,w=Object(f["a"])(g,I,C,!1,null,"28b97b1a",null),T=w.exports;function _(t,e,i,a,l,o,s,n){this.id=t||null,this.type=e||null,this.allocationType=i||null,this.jobItem=a,this.qtyFulfilled=l||0,this.costAllocation=o||0,this.qtyLines=s||null,this.lastShipmentIn=n||null}var x={name:"App",components:{ModalEntry:T,MaterialOrderTable:S},watch:{},mounted:function(){this.getMaterialOrderItems(),this.setAllocatedCost(),this.$refs.table.$refs.item.every((function(t){return!0===t.locked}))?this.$refs.table.locked=!0:this.$refs.table.locked=!1,this.setPercentAllocation()},created:function(){this.setShipmentList()},updated:function(){this.lifeCycleUpdated=!0,this.$refs.table.$refs.item.every((function(t){return!0===t.locked}))?this.$refs.table.locked=!0:this.$refs.table.locked=!1},data:function(){return{show:!1,confirmationShow:!1,saveConfirmationShow:!1,updated:!1,lifeCycleUpdated:!1,deletableItem:{jobItem:{name:null}},materialOrderId:null,totalCost:13498.04,allocatedCost:0,qtyLines:4,typeList:[{value:null,text:"Select..."},"FABs","Other","Parts","Services","Stencils"],allocationTypeList:[{value:null,text:"Select..."},"Inventory","Job"],shipmentList:[],materialOrderItems:[{id:Math.random(),type:"Parts",allocationType:"Inventory",jobItem:{id:Math.random(),name:"TPS-30961-A_2022-02-15",qty:3},qtyFulfilled:null,costAllocation:300,qtyLines:4,lastShipmentIn:this.getDate()},{id:Math.random(),type:"Parts",allocationType:"Inventory",jobItem:{id:Math.random(),name:"TPS-30961-A_2022-02-15",qty:3},qtyFulfilled:5,costAllocation:0,qtyLines:4,lastShipmentIn:new Date},{id:Math.random(),type:"Parts",allocationType:"Inventory",jobItem:{id:Math.random(),name:"TPS-30961-A_2022-02-15",qty:3},qtyFulfilled:1,costAllocation:50.64,qtyLines:4,lastShipmentIn:this.getDate()},{id:Math.random(),type:"Parts",allocationType:"Inventory",jobItem:{id:Math.random(),name:"TPS-30961-A_2022-02-15",qty:3},qtyFulfilled:3,costAllocation:43.67,qtyLines:4,lastShipmentIn:this.getDate()},{id:Math.random(),type:"Parts",allocationType:"Inventory",jobItem:{id:Math.random(),name:"TPS-30961-A_2022-02-15",qty:3},qtyFulfilled:6,costAllocation:0,qtyLines:4,lastShipmentIn:this.getDate()}]}},computed:{overUnderAllocated:function(){return this.totalAllocatedCost>this.totalCost||this.totalAllocatedCost<this.totalCost},isNegatives:function(){var t=!1;return this.materialOrderItems.forEach((function(e){-1===Math.sign(e.costAllocation)&&(t=!0)})),!!t},updatedAndNoNegatives:function(){var t=!1;return this.materialOrderItems.forEach((function(e){-1===Math.sign(e.costAllocation)&&(t=!0)})),!(!this.updated||t)},totalAllocatedCost:function(){var t=0;return this.materialOrderItems.forEach((function(e){t+=e.costAllocation})),0===t||t.toFixed(2)===this.totalCost.toFixed(2)?t.toFixed(2):Number(t.toString().match(/^\d+(?:\.\d{0,2})?/))}},methods:{getMaterialOrderItems:function(){var t=this,e=[];this.materialOrderItems.forEach((function(i){t.shipmentList.includes(i.lastShipmentIn)||(i.lastShipmentIn=null),e.push(new _(i.id,i.type,i.allocationType,i.jobItem,i.qtyFulfilled,i.costAllocation,i.qtyLines,i.lastShipmentIn))})),this.materialOrderItems=e},setShipmentList:function(){this.shipmentList=[this.getDate()]},setUpdated:function(t){this.updated=t},getDate:function(){var t=new Date;return t=t.getFullYear()+"-"+t.getMonth().toLocaleString("en-us",{minimumIntegerDigits:2})+"-"+t.getDate().toLocaleString("en-us",{minimumIntegerDigits:2}),t},handleSplit:function(){this.setUpdated(!0),this.setAllocatedCost(),this.setCostAllocation(),this.setPercentAllocation()},handleDistribute:function(){this.setUpdated(!0),this.distributeRemainingDollars(),this.setPercentAllocation()},saveChanges:function(){this.$refs.table.$refs.item.forEach((function(t){t.updated=!1,t.locked=!0})),this.saveConfirmationShow=!1},distributeRemainingDollars:function(){var t=this;if(this.materialOrderItems){var e=[];this.materialOrderItems.forEach((function(i){var a=t.$refs.table.$refs.item.find((function(t){return t.id===i.id}));!0!==a.locked&&e.push(i)}));var i=this.totalCost-parseFloat(this.totalAllocatedCost),a=Number((i/e.length).toString().match(/^\d+(?:\.\d{0,2})?/));e.forEach((function(t){e.indexOf(t)!==e.length-1?(t.costAllocation+=a,i-=a):t.costAllocation+=i}))}},setPercentAllocation:function(){var t=this;this.materialOrderItems.forEach((function(e){t.$refs.table.$refs.item[t.materialOrderItems.indexOf(e)]&&(t.$refs.table.$refs.item[t.materialOrderItems.indexOf(e)].percentAllocation=(t.materialOrderItems[t.materialOrderItems.indexOf(e)].costAllocation/t.totalCost*100).toFixed(2))}))},setAllocatedCost:function(){var t=this,e=0;this.materialOrderItems.forEach((function(i){if(i.costAllocation){var a=t.$refs.table.$refs.item.find((function(t){return t.id===i.id}));a.locked&&(e+=i.costAllocation)}})),this.allocatedCost=e},setQuantity:function(t,e){if(null==e){var i=this.$refs.table.$refs.item.find((function(e){return e.id===t.id}));!1===i.locked&&(t.qtyFulfilled=t.jobItem.qty,this.updateJobItem(t))}else t.qtyFulfilled=parseInt(e),this.updateJobItem(t)},updateJobItem:function(t){console.log("updated",t);var e=this.materialOrderItems[this.materialOrderItems.indexOf(this.materialOrderItems.find((function(e){return e.id===t.id})))];this.compareAllFields(t,e)||(this.$refs.table.$refs.item[this.materialOrderItems.indexOf(this.materialOrderItems.find((function(e){return e.id===t.id})))].updated=!0),this.$set(this.materialOrderItems,this.materialOrderItems.indexOf(this.materialOrderItems.find((function(e){return e.id===t.id}))),t)},compareAllFields:function(t,e){for(var i in t)if(e[i]!==t[i])return!1;return!0},setCostAllocation:function(){var t=this;if(console.log("setting cost allocation"),this.materialOrderItems){var e=[];this.materialOrderItems.forEach((function(i){var a=t.$refs.table.$refs.item.find((function(t){return t.id===i.id}));!0!==a.locked&&e.push(i)})),e.forEach((function(i){var a=t;if(e.indexOf(i)===e.length-1){var l=Object(n["a"])({},i);if(l.costAllocation=parseFloat(a.calculateCostAllocation(l)),0===l.costAllocation)return 0;a.updateJobItem(l),l.costAllocation=Number(l.costAllocation.toString().match(/^\d+(?:\.\d{0,2})?/));var o=a.totalCost-a.totalAllocatedCost;l.costAllocation+=o,l.costAllocation=Number(l.costAllocation.toFixed(2)),a.updateJobItem(l)}else{var s=Object(n["a"])({},i);s.costAllocation=parseFloat(a.calculateCostAllocation(s)),s.costAllocation=Number(s.costAllocation.toString().match(/^\d+(?:\.\d{0,2})?/)),a.updateJobItem(s)}}))}},calculateCostAllocation:function(t){var e=this,i=0;if(this.materialOrderItems.forEach((function(t){t.qtyFulfilled&&!e.$refs.table.$refs.item.find((function(e){return e.id===t.id})).locked&&(i+=t.qtyFulfilled)})),0===i)return 0;var a=(t.qtyFulfilled/i).toFixed(2);return(this.totalCost-this.allocatedCost)*a},setShow:function(t){this.show=t},resetDeletableItem:function(){this.deletableItem={jobItem:{name:null}}},createNewMaterialAllocation:function(t){var e=this;console.log(t),t.data.forEach((function(i){e.materialOrderItems.push(new _(Math.random(),t.type,t.allocationType,i,0,0,e.qtyLines,e.getDate()))}))},handleDelete:function(t){this.deletableItem=t,this.getConfirmation()},handleSave:function(){this.saveConfirmationShow=!0},getConfirmation:function(){this.confirmationShow=!0},deleteMaterialAllocation:function(t){this.materialOrderItems.splice(this.materialOrderItems.indexOf(this.materialOrderItems.find((function(e){return e.id===t.id}))),1),this.confirmationShow=!1,this.setUpdated(!0)}}},q=x,L=(i("034f"),Object(f["a"])(q,o,s,!1,null,null,null)),O=L.exports,j=i("b1e0");a["default"].use(l["a"]),a["default"].use(j["a"]),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(O)}}).$mount("#app")},8084:function(t,e,i){"use strict";i("4b24")},"85ec":function(t,e,i){},a6ac:function(t,e,i){}});
//# sourceMappingURL=app.80d23320.js.map